// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
}

// Supporters who have made a payment
model Supporter {
  id            String   @id @default(cuid())
  name          String
  email         String?
  tier          String   @default("single-clap") // single-clap, clap-squad, clap-champion, etc.
  amount        Float?   // Amount paid
  paymentMethod String?  // stripe, paypal
  paymentId     String?  // Stripe session ID or PayPal order ID
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([email])
  @@index([createdAt])
}

// Mailing list subscribers
model MailingListSubscriber {
  id            String   @id @default(cuid())
  email         String   @unique
  name          String?
  subscribedAt  DateTime @default(now())
  unsubscribedAt DateTime?
  isActive      Boolean  @default(true)

  @@index([email])
  @@index([isActive])
}

// Site statistics (for caching the clapper count)
model SiteStats {
  id            String   @id @default("main")
  clapperCount  Int      @default(64241)
  updatedAt     DateTime @updatedAt
}

// User locations for world map visualization
model UserLocation {
  id          String   @id @default(cuid())
  city        String
  country     String
  countryCode String   // ISO 3166-1 alpha-2 (e.g., "US", "DE")
  createdAt   DateTime @default(now())

  @@index([countryCode])
}
